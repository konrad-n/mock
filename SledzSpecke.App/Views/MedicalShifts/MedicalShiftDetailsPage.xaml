<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="SledzSpecke.App.Views.MedicalShifts.MedicalShiftDetailsPage"
             Title="{Binding Title}">

    <ScrollView>
        <StackLayout Padding="20" Spacing="15">
            <!-- Indykator ładowania -->
            <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" 
                               HorizontalOptions="Center" VerticalOptions="Center" />

            <StackLayout IsVisible="{Binding IsBusy, Converter={StaticResource InvertedBoolConverter}}">
                <!-- Informacja o zatwierdzeniu -->
                <Frame IsVisible="{Binding IsApproved}" 
                       BackgroundColor="#E6F7E6" 
                       BorderColor="#28A745" 
                       Padding="15" 
                       Margin="0,0,0,15">
                    <StackLayout>
                        <Label Text="Dyżur zatwierdzony" 
                               TextColor="#28A745" 
                               FontAttributes="Bold" 
                               FontSize="16" />
                        <Label Text="{Binding ApprovalDate, StringFormat='Data zatwierdzenia: {0:yyyy-MM-dd}'}" 
                               TextColor="#28A745" />
                        <Label Text="{Binding ApproverName, StringFormat='Zatwierdzone przez: {0}'}" 
                               TextColor="#28A745" />
                        <Label Text="{Binding ApproverRole, StringFormat='Funkcja: {0}'}" 
                               TextColor="#28A745" />
                    </StackLayout>
                </Frame>

                <!-- Informacja o stażu -->
                <Frame Style="{StaticResource CardFrame}">
                    <StackLayout>
                        <Label Text="Informacje o stażu" 
                               Style="{StaticResource SubHeaderLabel}" />
                        <BoxView HeightRequest="1" Color="#95B8CE" Margin="0,5,0,10" />

                        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto" 
                              ColumnSpacing="10" RowSpacing="10">
                            <Label Grid.Row="0" Grid.Column="0" 
                                   Text="Nazwa stażu:" 
                                   FontAttributes="Bold" />
                            <Label Grid.Row="0" Grid.Column="1" 
                                   Text="{Binding InternshipName}" />

                            <Label Grid.Row="1" Grid.Column="0" 
                                   Text="Instytucja:" 
                                   FontAttributes="Bold" />
                            <Label Grid.Row="1" Grid.Column="1" 
                                   Text="{Binding InternshipInstitution}" />
                        </Grid>
                    </StackLayout>
                </Frame>

                <!-- Informacje o dyżurze -->
                <Frame Style="{StaticResource CardFrame}">
                    <StackLayout>
                        <Label Text="Informacje o dyżurze" 
                               Style="{StaticResource SubHeaderLabel}" />
                        <BoxView HeightRequest="1" Color="#95B8CE" Margin="0,5,0,10" />

                        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto" 
                              ColumnSpacing="10" RowSpacing="10">
                            <!-- Data rozpoczęcia - zmieniono nazwę z "Data dyżuru" -->
                            <Label Grid.Row="0" Grid.Column="0" 
                                   Text="Data rozpoczęcia:" 
                                   FontAttributes="Bold" />
                            <Label Grid.Row="0" Grid.Column="1" 
                                   Text="{Binding Shift.Date, StringFormat='{0:yyyy-MM-dd}'}" />

                            <!-- Czas trwania -->
                            <Label Grid.Row="1" Grid.Column="0" 
                                   Text="Czas trwania:" 
                                   FontAttributes="Bold" />
                            <StackLayout Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                                <Label Text="{Binding Shift.Hours, StringFormat='Liczba godzin: {0}'}" Margin="0,0,10,0" />
                                <Label Text="{Binding Shift.Minutes, StringFormat='Liczba minut: {0}'}" />
                            </StackLayout>

                            <!-- Nazwa komórki organizacyjnej - zmieniono nazwę z "Miejsce dyżuru" -->
                            <Label Grid.Row="2" Grid.Column="0" 
                                   Text="Nazwa komórki organizacyjnej:" 
                                   FontAttributes="Bold" />
                            <Label Grid.Row="2" Grid.Column="1" 
                                   Text="{Binding Shift.Location}" />

                            <!-- Rok szkolenia -->
                            <Label Grid.Row="3" Grid.Column="0" 
                                   Text="Rok szkolenia:" 
                                   FontAttributes="Bold" />
                            <Label Grid.Row="3" Grid.Column="1" 
                                   Text="{Binding Shift.Year}" />

                            <!-- Status synchronizacji -->
                            <Label Grid.Row="4" Grid.Column="0" 
                                   Text="Status synchronizacji:" 
                                   FontAttributes="Bold" />
                            <Label Grid.Row="4" Grid.Column="1" 
                                   Text="{Binding SyncStatusText}" 
                                   TextColor="{Binding IsNotSynced, Converter={StaticResource BoolToTextColorConverter}}" />

                            <!-- Osoba nadzorująca - dla starego SMK -->
                            <Label Grid.Row="5" Grid.Column="0" 
                                   Text="Osoba nadzorująca:" 
                                   FontAttributes="Bold" 
                                   IsVisible="{Binding IsOldSMKVersion}" />
                            <Label Grid.Row="5" Grid.Column="1" 
                                   Text="{Binding OldSMKField1}" 
                                   IsVisible="{Binding IsOldSMKVersion}" />

                            <!-- Oddział - dla starego SMK -->
                            <Label Grid.Row="6" Grid.Column="0" 
                                   Text="Oddział:" 
                                   FontAttributes="Bold"
                                   IsVisible="{Binding IsOldSMKVersion}" />
                            <Label Grid.Row="6" Grid.Column="1" 
                                   Text="{Binding OldSMKField2}" 
                                   IsVisible="{Binding IsOldSMKVersion}" />
                        </Grid>
                    </StackLayout>
                </Frame>

                <!-- Przyciski akcji -->
                <StackLayout Orientation="Horizontal" Spacing="15" HorizontalOptions="Center"
                             Margin="0,15,0,0">
                    <Button Text="Edytuj" 
                            Command="{Binding EditCommand}" 
                            Style="{StaticResource PrimaryButton}"
                            IsEnabled="{Binding IsApproved, Converter={StaticResource InvertedBoolConverter}}" />
                    <Button Text="Usuń" 
                            Command="{Binding DeleteCommand}" 
                            Style="{StaticResource DangerButton}"
                            IsEnabled="{Binding IsApproved, Converter={StaticResource InvertedBoolConverter}}" />
                    <Button Text="Powrót" 
                            Command="{Binding GoBackCommand}" 
                            Style="{StaticResource OutlineButton}" />
                </StackLayout>
            </StackLayout>
        </StackLayout>
    </ScrollView>
</ContentPage>